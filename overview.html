<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview &mdash; TPS  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Build" href="build.html" />
    <link rel="prev" title="Torch Plasma Simulator" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TPS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flow-solver">Flow Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#governing-equations">Governing Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerics">Numerics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#capabilities">Capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#em-solver">EM Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Governing Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Numerics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/overview.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>The goal of the <code class="docutils literal notranslate"><span class="pre">TPS</span></code> code is to support high-fidelity simulations
of inductively coupled plasma (ICP) torches.  Towards this eventual
goal, the code currently supports single physics flow-only
simulations by solving the compressible Navier–Stokes (NS) equations
and electromagnetic-only simulations by solving the
quasimagnetostatic approximation of Maxwell’s equations.  Both models
are discretized using the finite element method (FEM), and both
solvers are implmented using the <a class="reference external" href="https://mfem.org">MFEM</a> library.
As the project continues, the codebase will evolve to support
additional physical models and multiphysics coupling to enable
efficient, high-fidelity simulations of ICP torches and related plasma
systems.</p>
<p><em>Note that this code is the product of an ongoing research project.
As such, the details described below, including both physical models
and numerical methods are subject to change in future versons of the
software.</em></p>
</section>
<hr class="docutils" />
<section id="flow-solver">
<h2>Flow Solver<a class="headerlink" href="#flow-solver" title="Permalink to this headline"></a></h2>
<section id="governing-equations">
<h3>Governing Equations<a class="headerlink" href="#governing-equations" title="Permalink to this headline"></a></h3>
<p>We consider the NS equations expressed in conservative form:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial U}{\partial t}+\nabla\cdot\mathbf{F}\left(U,\nabla V\right)=0\)</span></p>
<p>where <span class="math notranslate nohighlight">\(U=\left[\rho,\rho u_i,\rho E\right]^{T}\)</span> is the vector of
conservative variables, and <span class="math notranslate nohighlight">\(V=\left[\rho,u_i,p\right]^{T}\)</span> is
the vector of primitive variables with pressure
<span class="math notranslate nohighlight">\(p=\left(\gamma-1\right)\rho\left(E-\frac{1}{2} u_i u_i\right)\)</span>
and total energy <span class="math notranslate nohighlight">\(E=c_{v}T+\frac{1}{2}\left(u_i u_i\right)\)</span>.
Further, the flux in the <span class="math notranslate nohighlight">\(i\)</span> th direction is given by
<span class="math notranslate nohighlight">\(F_i=F^c_i-F^{v}_i\)</span> where <span class="math notranslate nohighlight">\(F^{c}_{i}, F^{v}_{i}\)</span> are the
convective and viscous fluxes in the <span class="math notranslate nohighlight">\(i\)</span> th direction,
respectively, defined as</p>
<p><span class="math notranslate nohighlight">\(F^{c}_i=\left[\begin{array}{c}
\rho u_i\\
\rho u_i u_j +p \delta_{ij}\\
u_i \left(\rho E+p\right)
\end{array}\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(F^{v}_i=\left[\begin{array}{c}
0 \\
\tau_{ij}\\
u_j \tau_{ji} - q_i
\end{array}\right]\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\tau_{ij}=\mu\left(\frac{\partial u_{i}}{\partial
x_{j}}+\frac{\partial u_{j}}{\partial x_{i}}\right)-\frac{2}{3}\mu
\frac{\partial u_k}{\partial k} \delta_{ij}\)</span> is the viscous stress
tensor and <span class="math notranslate nohighlight">\(q_i=-k \frac{\partial T}{\partial x_i}\)</span> is the
viscous heat flux.  The thermal conductivity is given by
<span class="math notranslate nohighlight">\(k=\frac{\mu c_{p}}{Pr}\)</span> where <span class="math notranslate nohighlight">\(Pr\)</span> is the Prandtl number,
estimated as <span class="math notranslate nohighlight">\(Pr=0.71\)</span> for air. The viscosity coefficient
follows Sutherland’s law
<span class="math notranslate nohighlight">\(\mu=\frac{1.458\cdot10^{-6}T^{3/2}}{T+110.4}\)</span>.</p>
<p>These equations may be written as the following first-order system:</p>
<p><span class="math notranslate nohighlight">\(\begin{aligned}\frac{\partial U}{\partial t}+\nabla\cdot\mathbf{F}\left(U,Q\right) &amp; =0\\
Q-\nabla V &amp; =0
\end{aligned}\)</span></p>
</section>
<hr class="docutils" />
<section id="numerics">
<h3>Numerics<a class="headerlink" href="#numerics" title="Permalink to this headline"></a></h3>
<p>We derive a discontinuous Galerkin formulation of the previous system in the usual manner,
multiplying by the test function <span class="math notranslate nohighlight">\(\ell_{j}\left(\xi\right)\)</span> and integrating over
the element</p>
<p><span class="math notranslate nohighlight">\(\frac{\mathrm{d}}{\mathrm{d}t}\intop_{\Omega_{e}}U^{e}\ell_{j}\left(x\right)\mathrm{d}x-\intop_{\Omega_{e}}\mathbf{F}\left(U,Q\right)\cdot\nabla\ell_{j}\left(x\right)\mathrm{d}x=-\intop_{\partial\varOmega_{e}}\mathbf{n}\cdot\mathbf{F}\left(U,Q\right)\ell_{j}\left(x\right)\mathrm{d}S\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\intop_{\varOmega_{e}}Q^{e}\ell_{j}\left(x\right)\mathrm{d}x=\intop_{\Omega_{e}}\ell_{j}\left(x\right)\nabla Q^{e}\mathrm{d}x+\intop_{\partial\Omega}\mathbf{n}\left[V^{*}-V^{e}\right]\ell_{j}\left(x\right)\mathrm{d}S\)</span></p>
<p>Since the solution is discontinuous across the interfaces, the fluxes are not defined at these
interfaces. This requires the definition of a numerical flux to be defined at the interfaces.
Different approaches exist for the definition of the fluxes which are solutions to the Riemann
problem. Currently two approaches are implemented, namely Lax-Friedrich and Roe solvers. Both
of these flux options are upwinded which renders the spatial discreitzation numerically dissipative.
In practice this means that wave lengths that are not well resolved are dissipated which
renders the scheme numerically stable (in a linear sense).</p>
<p>Once the domain is discretized the resulting system of equations is of the form:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial U}{\partial t}=R(U)\)</span></p>
<p>which can be integrated with a time integrator
scheme. Different <strong>explicit</strong> temporal schemes are currently available in
<code class="docutils literal notranslate"><span class="pre">TPS</span></code>.</p>
</section>
<hr class="docutils" />
<section id="capabilities">
<h3>Capabilities<a class="headerlink" href="#capabilities" title="Permalink to this headline"></a></h3>
<p>A summary of the main flow-solver capabilities are:</p>
<dl class="simple">
<dt>Upwinding</dt><dd><p>Roe and Lax-Friedrich interface luxes</p>
</dd>
<dt>HDF5 Output</dt><dd><p>The solver outputs the solution at constant iteration intervals. Paraview and
HDF5 ouputs are supported (the HDF5 variants are used when restarting the simulation).</p>
</dd>
<dt>Boundary Conditions</dt><dd><p>Several boundary conditions are provided including:.</p>
<ul class="simple">
<li><p>Adiabatic wall</p></li>
<li><p>Isothermal wall</p></li>
<li><p>Reflecting pressure outlet</p></li>
<li><p>Non-reflecting pressure outlet</p></li>
<li><p>Reflecting density and velocity input</p></li>
<li><p>Non-reflecting density and velocity input</p></li>
</ul>
</dd>
<dt>Communication &amp; computation overlap</dt><dd><p>In parallel simulations, communication of shared data between computational domains is
communicated concurrently with the computation of the interior of the domain.</p>
</dd>
<dt>Restart with arbitrary # of MPI tasks and order</dt><dd><p>When restarting the simulation it is possible to define a different polynomial order of the
solution. It is also possible to restart with a different number of MPI tasks (this requires
creating an intermediary serialized version of solution first).</p>
</dd>
<dt>GPU variants</dt><dd><p>It is also possible to run on GPU. Not all the features are available in the GPU version. In
particular it is not possible to run with variable time-step. The non-reflecting inlet is
similarly not available. See more details on the <a class="reference internal" href="build.html"><span class="doc">Build</span></a> page
for details on enabling GPU support.</p>
</dd>
</dl>
</section>
</section>
<hr class="docutils" />
<section id="em-solver">
<h2>EM Solver<a class="headerlink" href="#em-solver" title="Permalink to this headline"></a></h2>
<section id="id1">
<h3>Governing Equations<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h3>
<p>We support simulation of low-frequency electromagnetics using the
quasi-magnetostatic approximation of Maxwell’s equations.
Specifically, neglecting the displacement current and using a magnetic
vector potential based formulation, the Ampere-Maxwell equation
becomes</p>
<p><span class="math notranslate nohighlight">\(\nabla \times \left( \mu^{-1} \nabla \times A \right) = J\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the magnetic vector potential, <span class="math notranslate nohighlight">\(\mu\)</span> is the
magnetic permeability, and <span class="math notranslate nohighlight">\(J\)</span> is the current.  We assume that
the only conductors in the domain are those carrying the driving
current.  Thus, <span class="math notranslate nohighlight">\(J\)</span> represents a user-specified source
current.  Further, the existing implementation is highly specialized
to approximate the electromagnetic environment in a plasma torch
geometry.  As such, we assume that 1) the magnetic permeability of all
materials in the geometry is same and 2) the source current is
composed of “rings” of uniform current density.  In this situation, it
is convenient to non-dimensionalize the equation using a reference
length <span class="math notranslate nohighlight">\(\ell\)</span>, such as the ring radius, and the source current
magnitude <span class="math notranslate nohighlight">\(J_0\)</span>.  The resulting non-dimensional governing
equation is given by</p>
<p><span class="math notranslate nohighlight">\(\hat{\nabla} \times \hat{\nabla} \times \hat{A} = \hat{J}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\hat{A} = A/(\mu J_0 \ell^2)\)</span>, <span class="math notranslate nohighlight">\(\hat{\nabla} = \ell
\nabla\)</span>, and <span class="math notranslate nohighlight">\(\hat{J} = J/J_0\)</span>.  This is the equation approximated by
the solver.</p>
<p>Finally, perfect electrical conductor (PEC) boundary conditions are
assumed at all domain boundaries:</p>
<p><span class="math notranslate nohighlight">\(A \times n = 0\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(n\)</span> denotes the outward pointing unit normal.</p>
</section>
<hr class="docutils" />
<section id="id2">
<h3>Numerics<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>The weak form corresponding to the quasi-magnetostatic model with PEC
BCs is given by</p>
<p><span class="math notranslate nohighlight">\(\int_{\Omega} (\nabla \times v) \cdot (\nabla \times \hat{A}) \, \mathrm{d}x = \int_{\Omega} v \cdot \hat{J} \, \mathrm{d}x \quad \forall v \in H_0(curl; \Omega),\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\Omega\)</span> denotes the computational domain and
<span class="math notranslate nohighlight">\(H_0(curl; \Omega)\)</span> is the usual <span class="math notranslate nohighlight">\(H(curl)\)</span> space with
homogeneous Dirichlet boundary conditions:</p>
<p><span class="math notranslate nohighlight">\(H_0(curl; \Omega) = \left\{ v \in L^2(\Omega)^3 | \nabla \times v \in L^2(\Omega)^3, \, v \times n|_{\partial \Omega} = 0\right\}\)</span>,</p>
<p>with <span class="math notranslate nohighlight">\(\partial \Omega\)</span> denoting the boundary of the domain.</p>
<p>This weak form is discretized using <span class="math notranslate nohighlight">\(H(curl)\)</span>-conforming
“Nedelec” finite element as provided by MFEM, leading to a sparse
linear system.  This linear system is solved using the mimimum
residuals (MINRES) method with Auxiliary-space Maxwell Solver (AMS)
preconditioner from Hypre (through MFEM).</p>
</section>
</section>
</section>


           </div>
          </div>
<a href="https://github.com/pecos/tps">
  <img style="position: absolute; top: 0; right: 0; border: 0;"
       src="https://github.blog/wp-content/uploads/2008/12/forkme_right_gray_6d6d6d.png"
       alt="GitHub Repo">
</a>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Pecos Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>